[tox]
minversion = 4.0
envlist = lint, py314, py314-dataframe
isolated_build = true
skip_missing_interpreters = true

[testenv:lint]
basepython = python3.14
extras = dev
commands =
    ruff check .

[testenv]
basepython = python3.14
extras = dev
commands =
    python setup.py test {posargs}

[testenv:py314-dataframe]
basepython = python3.14
extras = dev, dataframe
commands =
    python setup.py test {posargs}
    python -c "import duckdb, polars as pl; from pathlib import Path; from tempfile import TemporaryDirectory; from intermine314.query import Query; assert hasattr(Query, 'dataframe') and hasattr(Query, 'to_parquet') and hasattr(Query, 'to_duckdb'); td = TemporaryDirectory(); p = Path(td.name) / 'smoke.parquet'; pl.DataFrame({'x':[1,2,3],'y':['a','b','c']}).write_parquet(p); con = duckdb.connect(database=':memory:'); got = con.execute('select sum(x) from read_parquet(?)', [str(p)]).fetchone()[0]; assert got == 6; td.cleanup()"

[testenv:live]
basepython = python3.14
extras = dev
commands =
    python setup.py livetest {posargs}
